<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Audio Processing Pipeline</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <div>
                    <h1>üéµ YouTube Audio Processing Pipeline</h1>
                    <p class="subtitle">Download, separate, and process YouTube audio</p>
                </div>
                <button id="logout-btn" class="btn btn-secondary" style="margin-top: 0;">Logout</button>
            </div>
        </header>

        <main>
            <div class="card">
                <h2>Process Song</h2>
                
                <div class="form-group">
                    <label for="youtube-input">YouTube URL or Search Query:</label>
                    <input 
                        type="text" 
                        id="youtube-input" 
                        placeholder="https://www.youtube.com/watch?v=... or 'artist - song title'"
                        class="input-field"
                    >
                    <small class="help-text">Enter a YouTube URL or search for a song</small>
                </div>

                <div class="form-group">
                    <label for="output-dir">Output Directory:</label>
                    <div class="input-group">
                        <input 
                            type="text" 
                            id="output-dir" 
                            placeholder="/app/output"
                            class="input-field"
                        >
                        <button id="browse-btn" class="btn btn-secondary">Choose Location</button>
                    </div>
                    <small class="help-text">Where to save the processed files</small>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input 
                            type="checkbox" 
                            id="upload-to-server"
                            class="checkbox-input"
                        >
                        <span>Upload to server after processing</span>
                    </label>
                    <small class="help-text">Enable this to upload the ZIP file to your configured server</small>
                </div>

                <div class="cookie-reminder">
                    <strong>üîí Cookie File Reminder:</strong> Make sure your cookie file (cookies.txt or www.youtube.com_cookies.txt) is up to date for age-restricted videos. Export fresh cookies from your browser if downloads fail.
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input 
                            type="checkbox" 
                            id="client-side-download"
                            class="checkbox-input"
                        >
                        <span><strong>Use Client-Side Download</strong> (Recommended for age-restricted videos)</span>
                    </label>
                    <small class="help-text">Download using YOUR IP address instead of Render's datacenter IP. This bypasses YouTube's bot detection. You'll download a script and run it on your machine.</small>
                </div>

                <div class="form-group" style="border: 2px dashed #4CAF50; padding: 15px; border-radius: 8px; background-color: #f0f8f0;">
                    <h3 style="margin-top: 0; color: #2e7d32;">üîÑ Workaround: Manual Download</h3>
                    <p style="margin: 10px 0; color: #555;">If automatic downloads fail, use this workaround:</p>
                    
                    <div style="margin: 15px 0;">
                        <button id="open-ytmp3-btn" class="btn" style="background-color: #4CAF50; color: white; margin-bottom: 10px;">
                            üåê Open ytmp3.as (Download MP3 there)
                        </button>
                        <small class="help-text" style="display: block; margin-top: 5px;">Click to open ytmp3.as in a new tab. Download the MP3, then upload it below.</small>
                    </div>

                    <div class="form-group" style="margin-top: 15px;">
                        <label for="manual-audio-file"><strong>Upload Audio File</strong> (from ytmp3.as or similar):</label>
                        <div class="input-group">
                            <input 
                                type="file" 
                                id="manual-audio-file"
                                accept="audio/*,.mp3,.m4a,.webm,.wav"
                                class="input-field"
                                style="padding: 8px;"
                            >
                            <button id="upload-manual-audio-btn" class="btn btn-secondary">Upload & Process</button>
                        </div>
                        <small class="help-text">Upload an audio file you downloaded from ytmp3.as or another service. We'll separate it into stems.</small>
                    </div>

                    <div class="form-group" style="margin-top: 15px;">
                        <label for="manual-download-url"><strong>Or Paste Direct Download URL:</strong></label>
                        <input 
                            type="text" 
                            id="manual-download-url"
                            placeholder="https://... (direct download URL from ytmp3.as or similar)"
                            class="input-field"
                        >
                        <small class="help-text">If you have a direct download URL, paste it here and we'll download it automatically.</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="cookies-file">Upload Cookies File (for age-restricted videos):</label>
                    <div class="input-group">
                        <input 
                            type="file" 
                            id="cookies-file" 
                            accept=".txt"
                            class="input-field"
                            style="padding: 8px;"
                        >
                        <button id="upload-cookies-btn" class="btn btn-secondary">Upload Cookies</button>
                    </div>
                    <small class="help-text">Upload a fresh cookies.txt file exported from your browser to access age-restricted videos</small>
                    <div id="cookies-status" class="cookie-status"></div>
                </div>

                <button id="process-btn" class="btn btn-primary">
                    <span id="btn-text">Process Song</span>
                    <span id="btn-spinner" class="spinner hidden"></span>
                </button>

                <div id="status" class="status-message"></div>
            </div>

            <div class="card">
                <h2>Progress</h2>
                <div class="progress-container">
                    <div id="progress-bar" class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                    <div id="progress-text" class="progress-text">Ready</div>
                </div>
            </div>

            <div class="card">
                <h2>Processing Log</h2>
                <div id="log-output" class="log-output"></div>
                <button id="clear-log-btn" class="btn btn-secondary btn-small">Clear Log</button>
            </div>
        </main>

        <footer>
            <p>YouTube Audio Processing Pipeline v1.0</p>
        </footer>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>


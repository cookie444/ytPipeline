# YouTube Audio Processing Pipeline - Flowchart

## Local Option Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    LOCAL DEPLOYMENT OPTION                      │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │  User Input:    │
                    │  Query String   │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Setup Config   │
                    │  config.json    │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Install Deps   │
                    │  pip install    │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Run Pipeline   │
                    │  python         │
                    │  pipeline.py    │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Search YouTube │
                    │  yt-dlp search  │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Download Audio │
                    │  Best Quality   │
                    │  Convert to WAV │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Separate Audio │
                    │  Demucs AI      │
                    │  (drums, vocals,│
                    │   guitar, synth)│
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Create ZIP     │
                    │  Archive        │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Upload to      │
                    │  Server (SCP)   │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Cleanup Temp   │
                    │  Files          │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Complete!      │
                    │  Files on Server│
                    └─────────────────┘
```

## Cloud Option Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    CLOUD DEPLOYMENT OPTION                      │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │  Build Docker   │
                    │  Image          │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Push to        │
                    │  Container      │
                    │  Registry       │
                    │  (ECR/GCR/ACR)  │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Deploy to      │
                    │  Cloud Platform │
                    │  ─────────────  │
                    │  • AWS ECS      │
                    │  • GCP Run Jobs │
                    │  • Azure ACI    │
                    │  • Kubernetes   │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Trigger Job    │
                    │  (API/CLI/      │
                    │   Scheduler)    │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Container      │
                    │  Starts         │
                    │  (Load Config)  │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Search YouTube │
                    │  yt-dlp search  │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Download Audio │
                    │  Best Quality   │
                    │  Convert to WAV │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Separate Audio │
                    │  Demucs AI      │
                    │  (drums, vocals,│
                    │   guitar, synth)│
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Create ZIP     │
                    │  Archive        │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Upload to      │
                    │  Server (SCP)   │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Cleanup Temp   │
                    │  Files          │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Container      │
                    │  Stops          │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Complete!      │
                    │  Files on Server│
                    └─────────────────┘
```

## Combined Decision Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    START: YouTube Pipeline                       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │  Choose Option  │
                    └────────┬────────┘
                             │
                ┌────────────┴────────────┐
                │                         │
                ▼                         ▼
    ┌───────────────────┐    ┌───────────────────┐
    │   LOCAL OPTION    │    │   CLOUD OPTION    │
    └─────────┬─────────┘    └─────────┬─────────┘
              │                         │
              ▼                         ▼
    ┌───────────────────┐    ┌───────────────────┐
    │ 1. Setup Config   │    │ 1. Build Docker   │
    │ 2. Install Deps   │    │ 2. Push to Reg    │
    │ 3. Run Script     │    │ 3. Deploy Cloud   │
    └─────────┬─────────┘    └─────────┬─────────┘
              │                         │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │   COMMON PIPELINE       │
              │   PROCESSING STEPS      │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │  Step 1: Search YouTube │
              │  ─────────────────────  │
              │  • Query: "artist-song"│
              │  • Find video URL       │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │  Step 2: Download Audio │
              │  ─────────────────────  │
              │  • Best quality format  │
              │  • Convert to WAV        │
              │  • Save to temp dir     │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │  Step 3: Separate Audio │
              │  ─────────────────────  │
              │  • Run Demucs AI        │
              │  • Extract stems:       │
              │    - drums.wav          │
              │    - vocals.wav         │
              │    - guitar.wav         │
              │    - synth.wav          │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │  Step 4: Create ZIP     │
              │  ─────────────────────  │
              │  • Package all stems    │
              │  • Compress archive     │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │  Step 5: Upload Server  │
              │  ─────────────────────  │
              │  • SCP connection       │
              │  • Transfer ZIP file    │
              │  • Verify upload        │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │  Step 6: Cleanup        │
              │  ─────────────────────  │
              │  • Remove temp files    │
              │  • Free disk space      │
              └─────────────┬───────────┘
                            │
                            ▼
              ┌─────────────────────────┐
              │      SUCCESS!           │
              │  ─────────────────────  │
              │  Files available on     │
              │  remote server          │
              └─────────────────────────┘
```

## API Server Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    API SERVER OPTION                            │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │  Start API      │
                    │  Server         │
                    │  (Flask)        │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Listen on      │
                    │  Port 5000      │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  POST /process  │
                    │  {query: "..."} │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Initialize     │
                    │  Pipeline       │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Run Pipeline   │
                    │  (Same steps    │
                    │   as above)     │
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Return JSON    │
                    │  Response       │
                    │  {success: true}│
                    └────────┬────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  Wait for Next  │
                    │  Request        │
                    └─────────────────┘
```

## Error Handling Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    ERROR HANDLING                                │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌─────────────────┐
                    │  Each Step      │
                    │  Has Try/Except │
                    └────────┬────────┘
                             │
                ┌────────────┴────────────┐
                │                         │
                ▼                         ▼
    ┌───────────────────┐    ┌───────────────────┐
    │   SUCCESS         │    │   ERROR           │
    └─────────┬─────────┘    └─────────┬─────────┘
              │                         │
              │                         ▼
              │              ┌───────────────────┐
              │              │  Log Error        │
              │              │  Print Stack      │
              │              └─────────┬─────────┘
              │                         │
              │                         ▼
              │              ┌───────────────────┐
              │              │  Cleanup Temp     │
              │              │  Files            │
              │              └─────────┬─────────┘
              │                         │
              │                         ▼
              │              ┌───────────────────┐
              │              │  Return False     │
              │              │  Exit with Code 1 │
              │              └───────────────────┘
              │
              ▼
    ┌───────────────────┐
    │  Continue to      │
    │  Next Step        │
    └───────────────────┘
```


